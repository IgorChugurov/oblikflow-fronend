# –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –°—Ç–∞—Ç—É—Å—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞

### 1. Draft (–ß–µ—Ä–Ω–æ–≤–∏–∫)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–∫—É–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —É—á–µ—Ç
- –í–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä—É –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
- –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- ‚Üí **Posted**: –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏
- ‚Üí **Deleted**: –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ —á–µ—Ä–Ω–æ–≤–∏–∫–∏)

### 2. Posted (–ü—Ä–æ–≤–µ–¥–µ–Ω)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–∫—É–º–µ–Ω—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω –∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —É—á–µ—Ç

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- –°–æ–∑–¥–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–ø—Ä–æ–≤–æ–¥–∫–∏, –¥–≤–∏–∂–µ–Ω–∏—è)
- –í–ª–∏—è–µ—Ç –Ω–∞ –æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ—Ç—á–µ—Ç—ã
- –ó–∞—â–∏—â–µ–Ω –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ü–µ—Ä–µ—Ö–æ–¥—ã:**
- ‚Üí **Cancelled**: –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ (—Å–æ–∑–¥–∞–µ—Ç —Å—Ç–æ—Ä–Ω–æ)

### 3. Cancelled (–û—Ç–º–µ–Ω–µ–Ω)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–∫—É–º–µ–Ω—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –°–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –ø—Ä–æ–≤–æ–¥–∫–∏
- –ù–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
- –í–∏–¥–µ–Ω –≤ –æ—Ç—á–µ—Ç–∞—Ö –∫–∞–∫ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–π
- –ù–µ–ª—å–∑—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

## –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –®–∞–≥ 1: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```typescript
const documentTypes = [
  { id: 'purchase', name: '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ', icon: 'üì¶' },
  { id: 'sale', name: '–ü—Ä–æ–¥–∞–∂–∞', icon: 'üõí' },
  { id: 'expense', name: '–†–∞—Å—Ö–æ–¥', icon: 'üí∞' },
  { id: 'income', name: '–î–æ—Ö–æ–¥', icon: 'üíµ' },
  { id: 'transfer', name: '–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ', icon: 'üîÑ' },
  { id: 'adjustment', name: '–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞', icon: '‚öñÔ∏è' }
];
```

### –®–∞–≥ 2: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–ø–∫–∏
**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û–ø–∏—Å–∞–Ω–∏–µ
- –í–∞–ª—é—Ç–∞ (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –±–∞–∑–æ–≤–æ–π)

### –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫
**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–æ–∫–∏:**
```typescript
interface DocumentLine {
  productId?: string;      // –¢–æ–≤–∞—Ä/—É—Å–ª—É–≥–∞
  description: string;     // –û–ø–∏—Å–∞–Ω–∏–µ
  quantity?: number;       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
  unitPrice?: MoneyAmount; // –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
  amount: MoneyAmount;     // –ò—Ç–æ–≥–æ –ø–æ —Å—Ç—Ä–æ–∫–µ
  taxRate?: number;        // –°—Ç–∞–≤–∫–∞ –ù–î–°
}
```

### –®–∞–≥ 4: –ê–≤—Ç–æ—Ä–∞—Å—á–µ—Ç—ã
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è:**
- –°—É–º–º–∞ –ø–æ —Å—Ç—Ä–æ–∫–∞–º
- –ù–î–° –ø–æ —Å—Ç–∞–≤–∫–∞–º
- –ò—Ç–æ–≥–æ–≤—ã–µ —Å—É–º–º—ã

### –®–∞–≥ 5: –í–∞–ª–∏–¥–∞—Ü–∏—è
**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- –°—É–º–º—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- –°—Å—ã–ª–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (–æ—Å—Ç–∞—Ç–∫–∏, –ª–∏–º–∏—Ç—ã)

## –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

### Pre-conditions
```typescript
const canPost = await checkDocumentPreconditions(documentId);

// –ü—Ä–æ–≤–µ—Ä–∫–∏:
- –î–æ–∫—É–º–µ–Ω—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ 'draft'
- –ü–µ—Ä–∏–æ–¥ –æ—Ç–∫—Ä—ã—Ç
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞
- –í—Å–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
```

### Preview –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è
**–ó–∞–ø—Ä–æ—Å:**
```http
POST /documents/{id}/preview
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "data": {
    "effects": [
      {
        "type": "inventory_movement",
        "description": "+10 Laptop to Main Warehouse",
        "quantity": 10
      },
      {
        "type": "gl_entry",
        "description": "Debit: Inventory 1,000 UAH, Credit: Accounts Payable 1,000 UAH",
        "amount": 100000 // –≤ –∫–æ–ø–µ–π–∫–∞—Ö
      }
    ],
    "warnings": [
      "Counterparty tax profile may require VAT recalculation"
    ]
  }
}
```

### –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ
**–ó–∞–ø—Ä–æ—Å:**
```http
POST /documents/{id}/post
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. **Lock resources** (–ø–µ—Ä–∏–æ–¥, –æ—Å—Ç–∞—Ç–∫–∏)
2. **Generate effects** (—Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)
3. **Validate balance** (GL –¥–µ–±–µ—Ç = –∫—Ä–µ–¥–∏—Ç)
4. **Persist transaction** (–∞—Ç–æ–º–∞—Ä–Ω–æ)
5. **Update status** ‚Üí 'posted'
6. **Async processing** (notifications, integrations)

## –û—Ç–º–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –¢–∏–ø—ã –æ—Ç–º–µ–Ω—ã

#### 1. Void (–û—Ç–º–µ–Ω–∞ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–µ—Ä–∏–æ–¥–∞)
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- –î–æ–∫—É–º–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 'cancelled'
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

#### 2. Reverse/Storno (–°—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –°–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –ø—Ä–æ–≤–æ–¥–∫–∏
- –î–æ–∫—É–º–µ–Ω—Ç –æ—Å—Ç–∞–µ—Ç—Å—è 'posted'
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è reversal_of_id

### –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–º–µ–Ω—ã
```http
POST /documents/{id}/cancel
Content-Type: application/json

{
  "reason": "Error in quantity",
  "reversalType": "void" // –∏–ª–∏ "reverse"
}
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –î–æ–∫—É–º–µ–Ω—Ç –∏ —Å–∫–ª–∞–¥
- **Purchase/Sale:** —Å–æ–∑–¥–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
- **Transfer:** –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ —É—á–µ—Ç–∞
- **Adjustment:** –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç –∏ —Ñ–∏–Ω–∞–Ω—Å—ã
- –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç GL –ø—Ä–æ–≤–æ–¥–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤
- –ú—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π

### –î–æ–∫—É–º–µ–Ω—Ç –∏ –±–∞–Ω–∫
- –°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- –°–≤–µ—Ä–∫–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π/–ø–ª–∞—Ç–µ–∂–µ–π

## UI —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –§–æ—Ä–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```typescript
interface DocumentFormState {
  isLoading: boolean;
  isDirty: boolean;
  canSave: boolean;
  canPost: boolean;
  validationErrors: ValidationError[];
  previewData?: EffectManifest;
}
```

### –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```typescript
interface DocumentListFilters {
  status?: DocumentStatus[];
  type?: DocumentType[];
  dateFrom?: string;
  dateTo?: string;
  counterpartyId?: string;
  amountMin?: number;
  amountMax?: number;
  search?: string;
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Document validation failed",
    "details": {
      "lines[0].quantity": {
        "code": "insufficient_stock",
        "message": "Only 5 items available, requested 10"
      }
    }
  }
}
```

### –ë–∏–∑–Ω–µ—Å-–æ—à–∏–±–∫–∏
```json
{
  "error": {
    "code": "PERIOD_CLOSED",
    "message": "Cannot post document: period is closed"
  }
}
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –æ—à–∏–±–∫–∏
- **Retry:** –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- **Report:** –¥–ª—è –±–∞–≥–æ–≤
- **Offline:** –æ—á–µ—Ä–µ–¥—å –æ–ø–µ—Ä–∞—Ü–∏–π

## –ê—É–¥–∏—Ç –∏ –∏—Å—Ç–æ—Ä–∏—è

### –ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ç–æ/–∫–æ–≥–¥–∞/—á—Ç–æ –∏–∑–º–µ–Ω–∏–ª
- Audit trail –¥–ª—è compliance

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –∞–≤—Ç–æ-—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∏
- Version history –¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Lazy loading:** —Å—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **Pagination:** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- **Caching:** —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (products, counterparties)
- **Background processing:** –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### Bulk operations
- –ú–∞—Å—Å–æ–≤–æ–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò–º–ø–æ—Ä—Ç –∏–∑ Excel
- Batch updates –¥–ª—è —Å—Ç—Ä–æ–∫